"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.defaultImportFn = defaultImportFn;
const tslib_1 = require("tslib");
const jiti_1 = tslib_1.__importDefault(require("jiti"));
let jiti;
function getOrCreateImportFn() {
    if (!jiti) {
        // we instantiate on demand because sometimes jiti is not used
        jiti = (0, jiti_1.default)(__filename);
    }
    return module => jiti.import(module, {});
}
async function defaultImportFn(path) {
    let module = await getOrCreateImportFn()(path);
    if (module.default != null) {
        module = module.default;
    }
    if (typeof module === 'object' && module != null) {
        const prototypeOfObject = Object.getPrototypeOf(module);
        if (prototypeOfObject == null || prototypeOfObject === Object.prototype) {
            const normalizedVal = {};
            for (const key in module) {
                normalizedVal[key] = module[key];
            }
            return normalizedVal;
        }
    }
    return module;
}
